#%Module1.0#####################################################################
##
## modules modulefile
##
## modulefiles/modules.  Generated from modules.in by configure.
##

# module whatis
set version     4.0.3
module-whatis   "ParMetis $version";

conflict ParMetis
conflict PrgEnv-cray PrgEnv-gnu PrgEnv-pgi

# What MPI

if { [info exists ::env(LMPI) ] } {
   set mpiflavor $::env(LMPI)
} elseif { [info exists ::env(PE_MPICH_MODULE_NAME) ] } {
   set mpiflavor $::env(PE_MPICH_MODULE_NAME)
} else {
   set mpiflavor cray-mpich
}

if { [info exists ::env(MPI_ROOT) ] } {
   set mpi $::env(MPI_ROOT)
   set mpiver [ lindex [ split "$mpi" "/" ] end ]
   set compilerver 0
} elseif { [info exists ::env(MPICH_DIR) ] } {
   set mpi $::env(MPICH_DIR)
   # set mpiver [ lindex [ split "$mpi" "/" ] end ]
   set compilerver [ lindex [ split "$mpi" "/" ] end ]
   set mpiflavor [ lindex [ split "$mpi" "/" ] 6 ]
   set mpiver [ lindex [ split "$mpi" "/" ] 4 ]
} else {
  set mpiver notset
  set compilerver notset
}

# local variables
set prefix      /usr/projects/draco/vendors/ParMetis-${version}/ci-${mpiflavor}-${compilerver}
set libdir      $prefix/lib
set incdir      $prefix/include

# module whatis
module-whatis   "Parmetis";

# module help
proc ModulesHelp { } {
   global version prefix bindir;

   puts stderr "\tParmetis\n";
   puts stderr "\tPARMETIS_LIB_DIR\t= $libdir";
   puts stderr "\tPARMETIS_INC_DIR\t= $incdir";
   puts stderr "\tMETIS_LIB_DIR\t= $libdir";
   puts stderr "\tMETIS_INC_DIR\t= $incdir";
}

if { ![file exists $prefix] } {
   puts stderr "\n[module-info name]: $prefix: No such file or directory.\n";
   break;
   exit 1;
}

setenv PARMETIS_LIB_DIR $libdir
setenv PARMETIS_INC_DIR $incdir
setenv METIS_LIB_DIR $libdir
setenv METIS_INC_DIR $incdir
