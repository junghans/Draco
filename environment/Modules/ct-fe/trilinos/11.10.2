#%Module1.0#####################################################################
##
## modules modulefile
##
## modulefiles/modules.  Generated from modules.in by configure.
##

# module whatis
set version 11.10.2
module-whatis   "Trilinos $version";

conflict trilinos
conflict PrgEnv-cray PrgEnv-gnu PrgEnv-pgi

# What MPI

if { [info exists ::env(LMPI) ] } {
   set mpiflavor $::env(LMPI)
} elseif { [info exists ::env(PE_MPICH_MODULE_NAME) ] } {
   set mpiflavor $::env(PE_MPICH_MODULE_NAME)
} else {
   set mpiflavor cray-mpich
}

if { [info exists ::env(MPI_ROOT) ] } {
   set mpi $::env(MPI_ROOT)
   set mpiver [ lindex [ split "$mpi" "/" ] end ]
   set compilerver 0
} elseif { [info exists ::env(MPICH_DIR) ] } {
   set mpi $::env(MPICH_DIR)
   # set mpiver [ lindex [ split "$mpi" "/" ] end ]
   set compilerver [ lindex [ split "$mpi" "/" ] end ]
   set mpiflavor [ lindex [ split "$mpi" "/" ] 6 ]
   set mpiver [ lindex [ split "$mpi" "/" ] 4 ]
} else {
  set mpiver notset
  set compilerver notset
}

# local variables
# set prefix      /usr/projects/draco/vendors/trilinos-$version/tlcc-${mpiflavor}-${mpiver}
set prefix      /usr/projects/draco/vendors/trilinos-$version/ci-${mpiflavor}-${compilerver}
set incdir      $prefix/include;
set libdir      $prefix/lib

# module help
proc ModulesHelp { } {
   global version prefix bindir;

   puts stderr "\tTrilinos $version\n";
   puts stderr "\tTRILINOS_INC_DIR\t= $incdir";
   puts stderr "\tTRILINOS_LIB_DIR\t= $libdir";
}

if { ![file exists $prefix] } {
   puts stderr "\n[module-info name]: $prefix: No such file or directory.\n";
   break;
   exit 1;
}

# Converting clients to embedded info in module files, rather
# than supporting client license files in the installation directory(s). 
# prepend-path    PATH            $bindir;

setenv TRILINOS_INC_DIR $incdir
setenv TRILINOS_LIB_DIR $libdir
