#!/usr/bin/env sh
#
# log_changes_since:
#
# usage:   changes_since date
#
# Parses the output from cvs history to find all files which have been
# modified or added since a given date, and who modified them.
#
# Will work only when executed in the top directory of a cvs checkout.
#
# Output is to stdout. 
#
# 'date' is some string that cvs recognizes in date
# arguments. "2008-02-23" and "yesterday" are both valid, for example.
#
# A nice addition would be to select users and default to "all". 

# Read repo name from CVS/Repository
exec 9< CVS/Repository
read -u 9 repo

# Get date argument
if [ -n "$1" ]
then
    date="$1"
else
    echo "I need a date."
    exit 1
fi

cvs -q history -x MA -D $date -a | \
   awk '$8 ~ /^'$repo'/{printf ("%10s   %s/%s\n",$5,$8,$7)}' | sort | uniq 