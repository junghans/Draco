##-*- Mode: sh -*-
##---------------------------------------------------------------------------##
## .bashrc_darwin - my bash configuration file upon bash login
##---------------------------------------------------------------------------##

if test -n "$verbose"; then
   echo "In .bashrc_darwin"
fi

##---------------------------------------------------------------------------##
## ENVIRONMENTS
##---------------------------------------------------------------------------##

# unlimit stack and core dump sizes.
ulimit -s unlimited

export VENDOR_DIR=/projects/opt/draco/vendors

# modules
if test -n "$MODULESHOME"; then
    module use ${VENDOR_DIR}/Modules
    module unload compilers mpi cmake
    module load other/emacs-24.3 subversion python/2.7.3 random123

    # Nodes that have MIC capability use different modules...
    if test -x /usr/sbin/micctrl; then
        mic_status=`/usr/sbin/micctrl -s | egrep mic[0-9]+ | wc -l`
    else
        mic_status=0
    fi

    if test ${mic_status} -gt 0; then
        # setup for draco
        module load compilers/intel/15.0.0 cmake/3.1.0
        module load mpi/intelmpi-5.0.1.035-mic
        module load numdiff/5.6.1-mic mkl/11.2-mic gsl/1.16-mic
        # additional setup for capsaicin
        module load ParMetis/4.0.3-mic SuperLU_DIST/3.3-mic trilinos/11.10.2-mic
    else
        # setup for draco
        module load compilers/intel/15.0.1 cmake/3.2.1
        module load mpi/intelmpi-5.0.2.044
        module load numdiff/5.2.1 eospac lapack/3.4.1
        # additional setup for capsaicin
        module load ParMetis/4.0.3 SuperLU_DIST/3.3 trilinos/11.10.2
    fi
    export CXX=`which mpiicpc`
    export CC=`which mpiicc`
    export FC=`which mpiifort`
    export MPIEXEC=`which mpirun`
fi

# Avoid printing trigraph chars to the screen (eg: ���)
export LANG=en_US

##---------------------------------------------------------------------------##
## end of .bashrc_darwin
##---------------------------------------------------------------------------##
