\documentclass[12pt]{article}
\usepackage{amsmath}
\headheight 0pt  \headsep 0pt
\topmargin 0pt  
\oddsidemargin 0pt  
\textheight 9 in \textwidth 6.5in

\begin{document}

\title{Multi-Material-Cell Material Properties Using a
	Temperature-Equilibration Treatment}
\author{J. M. McGhee}
\date{\today}

\maketitle

\newpage

\section{Introduction}

Many transport and diffusion codes make the assumption of constant material
properties over a computational cell.  In order for transport codes
of this type to interface with mesh descriptions which include multiple
materials in a computational cell, certain approximations are required.
This article describes one such method which we shall call
``temperature equilibration'' because only one temperature is returned
from the transport code for every material in a cell, regardless of
the initial input temperatures.

This method is somewhat arbitrary. It's virtues are simplicity 
combined with an attempt to do something
``reasonable'' based on energy conservation principles.
 However, it cannot be represented as a high order
accuracy mapping. The most accurate results can be expected with meshes which
minimize the number and size of multi-material cells. 


\section{Definitions}

Consider a computational cell which contains $nmat$  materials, numbered
$j = 1,nmat$. For purposes
of discussion, we make the following definitions:

\begin{description}
\item[$_j$] = a subscript to indicate material j.
\item[c$_{v,j}$] = heat capacity of material j (energy/length$^3$-temperature).
\item[T$_j$] = temperature of material j (temperature).
\item[V$_j$] = volume of material j (length$^3$).
\item[t] = problem time (time).
\item[$^n$] = a superscript to indicate a value at the start of a time-step.
\item[$^{n+1}$] = a superscript to indicate a value at the end of a time-step.
\item[$\overline{x}$]=  over bar to indicate a cell-average value of some
 quantity ``x''.
\item[$\Delta E_{j}$] = $(E_{j}^{n+1} - E_{j}^{n})$, change in energy of 
	material j over a time-step (energy).
\end{description}


\section{Goals}


We assume that some method is available which is capable of producing
individual material properties as required. 
For computational cells which contain multiple materials,
we seek to construct a scheme which provides the following services:
\begin{itemize}
 \item Given a set of material temperatures and densities on input at t$^n$,
       and the means to calculate individual material properties:
 \begin{itemize}
   \item Provide a means to calculate a cell average temperature.
   \item Provide a means to calculate cell based average material properties.
   \item Provide a means to calculate face based average material
	 properties.
 \end{itemize}
\item Given a cell average energy deposition  upon exit at t$^{n+1}$:
\begin{itemize} 
  \item Provide a means to calculate an  energy deposition for each
        material in the cell.
  \item Provide a means to calculate a temperature for each material in 
        the cell.
\end{itemize}
\end{itemize}



\section{Temperature Equilibration Formula}

We calculate all individual material properties at the input
temperature and density and assume the resulting properties to be constant 
over the time-step.  Given this data, we now wish to construct
a cell-average temperature.
From conservation of energy considerations it is possible to calculate
the uniform temperature $\overline{T}$ of a mix of $nmat$ materials 
each with a temperature $T_j$, should
the mix be allowed to come to thermal equilibrium.
In such a case, the volume-integrated sum of the material-wise 
energy gains and losses must equal zero:
\begin{equation}
\sum_{j=1}^{nmat} c_{v,j} V_{j} (\overline{T}-T_{j}) = 0
\end{equation}
Solving for $\overline{T}$:
\begin{equation}
\overline{T} = \frac{\sum_{j=1}^{nmat}c_{v,j}V_{j}T_{j}}
	{\sum_{j=1}^{nmat}c_{v,j}V_{j}}
\label{eq:tbar}
\end{equation}
This equation provides a formula for the calculation of 
cell average temperatures. 

\section{Initialization of Radiation Intensity}

On the first time-step, the radiation intensity in a multi-material cell
can be initialized to a value consistent
with the cell average temperature calculated from equation~(\ref{eq:tbar}).
 On subsequent time-steps the intensity
from the previous time-step can be used as an initial intensity.
No attempt is made to map intensities from cell-average values to
individual materials or visa-versa.

\section{Cell Average Material Properties}

We calculate the effective average heat capacity of a cell as an example
material property. Again using the principal of energy conservation, 
we wish to calculate a $\overline{c}_{v}$ such that:
\begin{equation}
\sum_{j=1}^{nmat} \overline{c}_{v}  V_{j} 
(\overline{T}^{n+1}-\overline{T}^{n})   = 
\sum_{j=1}^{nmat} c_{v,j} V_{j} (T_{j}^{n+1}-T_{j}^{n})
\end{equation}
Using the definition of $\overline{T}$ from equation~(\ref{eq:tbar}):
\begin{equation}
\sum_{j=1}^{nmat}  \overline{c}_{v} V_{j}  
(\overline{T}^{n+1}-\overline{T}^{n})   = 
 \sum_{j=1}^{nmat} c_{v,j} V_{j} (\overline{T}^{n+1}-\overline{T}^{n})
\end{equation}
Solving for $\overline{c}_{v}$:
\begin{equation}
\overline{c}_{v} = \frac{ \sum_{j=1}^{nmat} c_{v,j} V_{j} } 
{\sum_{j=1}^{nmat} V_{j}}
\label{eq:cvbar}
\end{equation}


As an additional example, consider the calculation of cell average absorption
opacities, $\overline{\sigma}_a$ (length$^{-1}$).
 Let $\overline{\phi}$ be the cell 
average intensity (energy/length$^2$-time). Conservation of radiation
energy absorption then demands:
\begin{equation}
 \sum_{j=1}^{nmat} \overline{\sigma}_a V_j \overline{\phi} =
\sum_{j=1}^{nmat} \sigma_{a,j} V_j \overline{\phi}
\end{equation}
Solving for $\overline{\sigma}_a$:
\begin{equation}
\overline{\sigma}_{a} = \frac{ \sum_{j=1}^{nmat} \sigma_{a,j} V_{j} } 
{\sum_{j=1}^{nmat} V_{j}}
\end{equation}

Other material properties can be calculated in a fashion similar
to the specific heat and the absorption opacity, i.e.,
as a volume weighted average.


\section{Determination of Face Temperatures}

Spatial differencing schemes which place the material temperatures at
computational cell centers often require material properties definitions
on the cell faces for purposes of calculating flow from the cell. 
In order to propagate a Marshak temperature wave  
in a ``reasonable'' manner, it has been observed
that these face material properties should be calculated at a temperature
which is  some average of the cell center temperatures. In this section
we provide a means to estimate such a face temperature.

Using equation~(\ref{eq:tbar}) to calculate an average temperature
 $\overline{T}$ on each cell, we make the following definitions:
\begin{description}
\item[$\gamma$] = a user selectable constant between zero and one.
\item[$\overline{T}_{A}$] = the $\overline{T}$ in the cell which is adjacent
      to the shared face on which we wish to calculate a temperature.
\item[$T_{H}$] = $\max( \overline{T}, \overline{T}_{A})$
\item[$T_{L}$] = $\min( \overline{T}, \overline{T}_{A})$
\end{description}
We then use the following procedure to estimate a face temperature for
each material in the cell:
\begin{equation}
\alpha_{F} = (\gamma T_{H} + (1 - \gamma) T_{L})/\overline{T}
\end{equation}
\begin{equation}
T_{F,j} = \alpha_{F}T_{j}, \; \; j=1,nmat
\end{equation}
where the subscript $_{F}$ indicates a face value. Given a face
temperature, calculation of material properties can then proceed
in the same manner as for cell centers.
For material properties which are temperature dependent, the amount of
energy propagated from one cell to another is affected by the choice of the
constant $\gamma$. Lacking any information about material properties
in the general case, we recommend a value of $\gamma = 0.5$ as a
reasonable initial value.

\section{Transport Calculation}

Given cell-average data computed from the formulas in the
preceding sections, a uni-material cell transport method can
be invoked to advance the various cell-average unknowns 
from t$^{n}$ to t$^{n+1}$
in the usual manner. The formulas to be presented in the following
sections can then be used to map the new cell-average values to
the individual materials in multi-material cells.

\section{Material Temperatures at $t^{n+1}$}

The hallmark of the temperature-equilibration method is to assume
that all materials in a cell are at the some uniform temperature 
$\widehat{T}^{n+1}$
at the end of a time-cycle:
\begin{equation}
T_{j}^{n+1} = \widehat{T}^{n+1}
\end{equation}
In order to determine the value of $\widehat{T}^{n+1}$ 
we write an energy balance equation within the computational cell:
\begin{equation}
 \sum_{j=1}^{nmat} \overline{c}_{v} V_{j} 
(\overline{T}^{n+1}-\overline{T}^{n}) = 
\sum_{j=1}^{nmat} c_{v,j} V_{j} (\widehat{T}^{n+1} - T_{j}^{n})
\end{equation}
Rearranging terms to solve for $\widehat{T}^{n+1}$:
\begin{equation}
\widehat{T}^{n+1} = \frac{ \sum_{j=1}^{nmat} \overline{c}_{v} V_{j}    
(\overline{T}^{n+1}-\overline{T}^{n}) +
\sum_{j=1}^{nmat} c_{v,j} V_{j} T_{j}^{n} }
{\sum_{j=1}^{nmat} c_{v,j}V_{j}}
\end{equation}
Substituting from equation~(\ref{eq:cvbar}) for $\overline{c}_{v}$, and
making use of the definition of $\overline{T}$ given in 
equation~(\ref{eq:tbar}), we find:
\begin{equation}
\widehat{T}^{n+1} = \overline{T}^{n+1} - \overline{T}^{n} + \overline{T}^{n}
\end{equation}
\begin{equation}
\widehat{T}^{n+1} = \overline{T}^{n+1}
\end{equation}
Thus we find that the end-of-cycle material temperatures are simply the cell
average end-of-cycle temperature.

\section{Material Energy Deposition}
Given individual material temperatures from the preceding section,
calculation of individual material energy depositions is straight-forward:
\begin{equation}
\Delta E_{j} = c_{v,j} V_{j} (\overline{T}^{n+1}-T_{j}^{n})
\end{equation}
The total energy deposited in the cell can then be calculated as
the sum of the individual material energy changes:
\begin{equation}
\Delta E = \sum_{j=1}^{nmat} \Delta E_{j}
\end{equation}
or, equivalently, in terms of cell average quantities:
\begin{equation}
\Delta E = \overline{c}_{v}\sum_{j=1}^{nmat} V_{j}
(\overline{T}^{n+1} - \overline{T}^{n})
\end{equation}


\section{Method Characteristics}

\subsection{Strengths}

This procedure is simple and computationally straight forward. It
can be implemented as a ``pre'' and ``post'' processor. No 
modifications to a uni-material cell transport algorithm are required.

This procedure can be shown to conserve energy. No energy is gained or
lost in the map from cell average energy deposition and temperature to
individual material energy depositions and temperatures.

The behavior of a multiple-material cell which happens to contain
only  one material is indistinguishable from a single material cell.

The steady-state thermal equilibrium solution is automatically 
accommodated, as all the materials in a cell are guaranteed to be at
equilibrium upon exit from every time cycle.

\subsection{Weaknesses}

The cell average temperature does not provide the ``correct''
emission source as this is based on $T^4$, not $T$.

Any initial temperature difference between materials in a 
multi-material cell is immediately lost.

\nocite{MihalasMihalas}
\bibliographystyle{plain}
\bibliography{MultiMaterialCell}

\end{document}
