\documentclass[12pt]{article}
\usepackage{amsmath}
\headheight 0pt  \headsep 0pt
\topmargin 0pt  
\oddsidemargin 0pt  
\textheight 9 in \textwidth 6.5in

\begin{document}

\title{Multi-Material-Cell Material Properties Using a
	Temperature-Equilibration Treatment}
\author{J. M. McGhee}
\date{\today}

\maketitle

\newpage

\section{Introduction}

Many transport and diffusion codes make the assumption of constant material
properties over a computational cell.  In order for transport codes
of this type to interface with mesh descriptions which include multiple
materials in a computational cell, certain approximations are required.
This article describes one such method which we shall call
``temperature equilibration'' because only one temperature is returned
from the transport code for every material in a cell, regardless of
the initial input temperatures.



\section{Definitions}

Consider a computational cell which contains $nmat$  materials, numbered
$j = 1,nmat$. For purposes
of discussion, we make the following definitions:

\begin{description}
\item[$_j$] = a subscript to indicate material j.
\item[c$_{v,j}$] = heat capacity of material j (energy/length$^3$-temperature).
\item[T$_j$] = temperature of material j (temperature).
\item[V$_j$] = volume of material j (length$^3$).
\item[t] = problem time (time).
\item[$^n$] = a superscript to indicate a value at the start of a time-step.
\item[$^{n+1}$] = a superscript to indicate a value at the end of a time-step.
\item[$\overline{x}$]=  over bar to indicate a cell-average value of some
 quantity ``x''.
\item[$\Delta E_{j}$] = $(E_{j}^{n+1} - E_{j}^{n})$, change in energy of 
	material j over a time-step (energy).
\end{description}


\section{Goals}


We assume that some method is available which is capable of producing
individual material properties as required. 
For computational cells which contain multiple materials,
we seek to construct a scheme which provides the following services:
\begin{itemize}
 \item Given a set of material temperatures and densities on input at t$^n$,
       and the means to calculate individual material properties:
 \begin{itemize}
   \item Provide a means to calculate a cell average temperature.
   \item Provide a means to calculate cell based average material properties.
   \item Provide a means to calculate face based average material
	 properties.
 \end{itemize}
\item Given a cell average energy deposition  upon exit at t$^{n+1}$:
\begin{itemize} 
  \item Provide a means to calculate an  energy deposition for each
        material in the cell.
  \item Provide a means to calculate a temperature for each material in 
        the cell.
\end{itemize}
\end{itemize}



\section{Temperature Equilibration Formula}

We calculate all individual material properties at the input
temperature and density and assume the resulting properties to be constant 
over the time-step.  Given this data, we now wish to construct
a cell-average temperature.
From conservation of energy considerations it is possible to calculate
the uniform temperature $\overline{T}$ of a mix of $nmat$ materials 
each with a temperature $T_j$, should
the mix be allowed to come to thermal equilibrium.
In such a case, the volume-integrated sum of the material-wise 
energy gains and losses must equal zero:
\begin{equation}
\sum_{j=1}^{nmat} c_{v,j} V_{j} (\overline{T}-T_{j}) = 0
\end{equation}
Solving for $\overline{T}$:
\begin{equation}
\overline{T} = \frac{\sum_{j=1}^{nmat}c_{v,j}V_{j}T_{j}}
	{\sum_{j=1}^{nmat}c_{v,j}V_{j}}
\label{eq:tbar}
\end{equation}
This equation provides a formula for the calculation of 
cell average temperatures.

\section{Cell Average Material Properties}

We calculate  effective average heat capacity of a cell as an example
material property. Again using the principal of energy conservation, 
we wish to calculate a $\overline{c_{v}}$ such that:
\begin{equation}
\sum_{j=1}^{nmat} \overline{c_{v}}  V_{j} (\overline{T}^{n+1}-\overline{T}^{n})   = 
\sum_{j=1}^{nmat} c_{v,j} V_{j} (T_{j}^{n+1}-T_{j}^{n})
\end{equation}
Using the definition of $\overline{T}$ from equation~(\ref{eq:tbar}):
\begin{equation}
\sum_{j=1}^{nmat}  \overline{c_{v}} V_{j}  
(\overline{T}^{n+1}-\overline{T}^{n})   = 
 \sum_{j=1}^{nmat} c_{v,j} V_{j} (\overline{T}^{n+1}-\overline{T}^{n})
\end{equation}
Solving for $\overline{c_{v}}$:
\begin{equation}
\overline{c_{v}} = \frac{ \sum_{j=1}^{nmat} c_{v,j} V_{j} } 
{\sum_{j=1}^{nmat} V_{j}}
\label{eq:cvbar}
\end{equation}
Other material properties can be calculated in a similar fashion, i.e.,
as a volume weighted average.

\section{Material Temperatures at $t^{n+1}$}

The hallmark of the temperature-equilibration method is to assume
that all materials in a cell are at the some uniform temperature 
$\widehat{T}^{n+1}$
at the end of a time-cycle:
\begin{equation}
T_{j}^{n+1} = \widehat{T}^{n+1}
\end{equation}
In order to determine the value of $\widehat{T}^{n+1}$ 
we write an energy balance equation within the computational cell:
\begin{equation}
 \sum_{j=1}^{nmat} \overline{c_{v}} V_{j} 
(\overline{T}^{n+1}-\overline{T}^{n}) = 
\sum_{j=1}^{nmat} c_{v,j} V_{j} (\widehat{T}^{n+1} - T_{j}^{n})
\end{equation}
Rearranging terms to solve for $\widehat{T}^{n+1}$:
\begin{equation}
\widehat{T}^{n+1} = \frac{ \sum_{j=1}^{nmat} \overline{c_{v}} V_{j}    
(\overline{T}^{n+1}-\overline{T}^{n}) +
\sum_{j=1}^{nmat} c_{v,j} V_{j} T_{j}^{n} }
{\sum_{j=1}^{nmat} c_{v,j}V_{j}}
\end{equation}
Substituting from equation~(\ref{eq:cvbar}) for $\overline{c_{v}}$, and
making use of the definition of $\overline{T}$ given in 
equation~(\ref{eq:tbar}), we find:
\begin{equation}
\widehat{T}^{n+1} = \overline{T}^{n+1} - \overline{T}^{n} + \overline{T}^{n}
\end{equation}
\begin{equation}
\widehat{T}^{n+1} = \overline{T}^{n+1}
\end{equation}
Thus we find that the end-of-cycle material temperatures are simply the cell
average end-of-cycle temperature.

\section{Material Energy Deposition}
Given individual material temperatures from the preceding section,
calculation of individual material energy depositions is straight-forward:
\begin{equation}
\Delta E_{j} = c_{v,j} V_{j} (\overline{T}^{n+1}-T_{j}^{n})
\end{equation}
The total energy deposited in the cell can then be calculated as
the sum of the individual material energy changes:
\begin{equation}
\Delta E = \sum_{j=1}^{nmat} \Delta E_{j}
\end{equation}
or, alternatively, in terms of cell average quantities:
\begin{equation}
\Delta E = \overline{c_v}\sum_{j=1}^{nmat} V_{j}
(\overline{T}^{n+1} - \overline{T}^{n})
\end{equation}

\section{Determination of Face Temperatures}

Spatial differencing schemes which place the material temperatures at
computational cell centers often require material properties definitions
on the cell faces for purposes of calculating flow from the cell. 
In order to ``reasonably'' propagate a Marshak temperature wave,  it has been observed
that these face material properties should be calculated at a temperature
which is  some average of the cell center temperatures. In this section
we provide a means to estimate such a face temperature.

Using equation~(\ref{eq:tbar}) to calculate an average temperature
 $\overline{T}$ on each cell, we make the following definitions:
\begin{description}
\item[$\gamma$] = a user selectable constant between zero and one.
\item[$\overline{T_{A}}$] = the $\overline{T}$ in the cell which is adjacent
      to the shared face on which we wish to calculate a temperature.
\item[$T_{H}$] = $\max( \overline{T}, \overline{T_{A}})$
\item[$T_{L}$] = $\min( \overline{T}, \overline{T_{A}})$
\end{description}
We then use  following procedure to estimate a face temperature for
each material in the cell:
\begin{equation}
\alpha_{F} = (\gamma T_{H} + (1 - \gamma) T_{L})/\overline{T}
\end{equation}
\begin{equation}
T_{F,j} = \alpha_{F}T_{j}, j=1,nmat
\end{equation}
where the subscript $_{F}$ indicates a face value. Given a face
temperature, calculation of material properties can then proceed
in the same manner as for cell centers.
For material properties which are temperature dependent, the amount of
energy propagated from one cell to another is affected by the
constant $\gamma$. Lacking any information about material properties
in the general case, we recommend a value of $\gamma = 0.5$ as a
reasonable initial value.

\section{Method Characteristics}

This procedure can be shown to conserve energy. No energy is gained or
lost in the map from cell average energy deposition and temperature to
individual material energy depositions and temperatures.

The behavior of a multiple-material cell which happens to contain
only  one material is indistinguishable from a single material cell.

Also, this scheme accommodates the steady-state thermal equilibrium
solution, as all the materials in a cell are guaranteed to be at
equilibrium upon exit from every time cycle.

However, the cell average temperature does not provide the ``correct''
emission source as this is based on $T^4$, not $T$.

\nocite{MihalasMihalas}
\bibliographystyle{plain}
\bibliography{MultiMaterialCell}

\end{document}
