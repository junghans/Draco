###############################################################################
# draco/autodoc Makefile.in
# Thomas M. Evans
# Wed Sep  1 16:14:07 1999
# $Id$
###############################################################################
# @> General Makefile.in for draco/autodoc
###############################################################################

# @configure_input@

# Automatic autoconf variables:
top_srcdir = @top_srcdir@
srcdir = @srcdir@

# get the relative directory between the top_srcdir and the srcdir
reldir := $(shell echo "${srcdir}" | sed s%${top_srcdir}%% | sed 's%/[^/]*%../%g')
ifeq (,${reldir})
  reldir := "."
endif

# doxygen executable
DOXYGEN = @DOXYGEN_PATH@

#installation executable
INSTALL = @INSTALL@

# package name
package = @package@

# directory for doxygen output
doxygen_output = @doxygen_output@

# pacakage top source directory
package_top_srcdir = @package_top_srcdir@

# Get the config directory from the package root.
config_dir = ${package_top_srcdir}/config

# get the pkg_config directory and include statement
pkg_config_dir  = ${package_top_srcdir}/pkg_config
pkg_config_inc := $(shell if test -d ${pkg_config_dir}; then \
                    echo "-I ${pkg_config_dir}"; fi)

# Get the autodoc directory from the package root
top_autodoc_dir = ${package_top_srcdir}/autodoc

# Build lists of image files and support files in the top autodoc
# directory and the local autodoc directory. The local directory files
# are listed last to override earlier entries in the autodoc dir

imagefiles=$(wildcard ${top_autodoc_dir}/html/*.png)\
	$(wildcard ${top_autodoc_dir}/html/*.gif)\
	$(wildcard ${top_autodoc_dir}/html/*.jpg)\
	$(wildcard ${srcdir}/autodoc/*.png)\
	$(wildcard ${srcdir}/autodoc/*.gif)\
	$(wildcard ${srcdir}/autodoc/*.jpg)

supportfiles=$(wildcard ${top_autodoc_dir}/html/*.css)\
	$(wildcard ${top_autodoc_dir}/html/*.html)\
	$(wildcard ${srcdir}/autodoc/*.css)\
	$(wildcard ${srcdir}/autodoc/*.html)

tagfiles = @TAGFILES@

##---------------------------------------------------------------------------##

# .SUFFIXES : .png .gif .jpg .css .html
.PHONY : html latex install autodoc configure reconfigure \
	install_support install_images tagfile_target

autodoc: html

html latex: install_images install_support ${tagfiles}
	@if test ${DOXYGEN} = 'null'; then \
	   echo Doxygen not available; \
	else \
	   ${DOXYGEN} doxygen_config; \
	fi

install:

check:

##---------------------------------------------------------------------------##
## Install support files

install_images: ${imagefiles} 
	@for file in ${imagefiles}; do \
	   echo "Install $${file} to ${doxygen_output}";\
	   ${INSTALL} $${file} ${doxygen_output}/; \
	done

install_support: ${supportfiles} 
	@for file in ${supportfiles}; do \
	   echo "Install $${file} to ${doxygen_output}";\
	   ${INSTALL} $${file} ${doxygen_output}/; \
	done


##---------------------------------------------------------------------------##
## Build system targets and rules

configure:
	@echo "Rebuilding ${top_srcdir}/aclocal.m4"
	@cd ${top_srcdir} && aclocal -I ${config_dir} ${pkg_config_inc}
	@echo "Rebuilding ${top_srcdir}/configure"
	@cd ${top_srcdir} && autoconf
	@cd ${reldir} && ./config.status --recheck
	@cd ${reldir} && ./config.status

reconfigure:
	@cd ${reldir} && ./config.status --recheck
	@cd ${reldir} && ./config.status

##---------------------------------------------------------------------------##
## clean targets

clean: forced-clean

forced-clean:
	-rm -rf ${doxygen_output}/*
#	-rm -rf ${prefix}/latex/*

mostlyclean: clean

distclean: mostlyclean forced-distclean

forced-distclean:
	-rm -f config.status config.cache config.log
	-rm -f header.html footer.html doxygen_config
	-rm -f Makefile

###############################################################################
#			 end of draco/autodoc Makefile.in
###############################################################################
