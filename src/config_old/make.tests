############################### -*-makefile-*- ################################
# gts/src/config/make.tests
# Geoffrey Furnish
# 21 August 1996
#
# Copyright 1996 The Regents of the University of California. 
# All rights reserved.
###############################################################################
# This makefile provides a standard way to build a package's test
# programs. 
###############################################################################

comma:= ,
empty:=
space:= $(empty) $(empty)

ifdef do
do2 = $(subst $(comma),$(space),$(do))
tstprogs	= $(do2:%=%_$(env))
else
tstprogs	= $(tstsrcs:%.cc=%_$(env))
endif

tests: $(tstpretarg) $(tstprogs)

# Set the library to link the tests against.  Normally we have to add
# the default library for the current directory, since it won't be in
# LINK_LIBS.  However, it has to be possible to override this, in the
# case of a directory where there is no actual library.  The
# "expression math library" in directory xm is like this, for example.

ifndef notstlib
tstlib = -L. -l$(pkg)_$(env)
endif

$(tstprogs) : %_$(env) : $(default_lib) $(env)/%.o
	$(CXX) $(CXXFLAGS) -o $@ $(env)/$*.o $(tstlib) $(LINK_LIBS)

###############################################################################
#                           End of config/make.tests
###############################################################################
