//----------------------------------*-C++-*----------------------------------//
// MatVec_3T.cc
// Geoffrey M. Furnish
// Wed Nov 26 16:18:47 1997
//---------------------------------------------------------------------------//
// @> 
//---------------------------------------------------------------------------//

#include "3T/MatVec_3T.hh"

#include "c4/global.hh"
#include "c4/C4_Req.hh"
#include "c4/SpinLock.hh"
using namespace C4;

#include <stdio.h>

//---------------------------------------------------------------------------//
// Constructor.
//---------------------------------------------------------------------------//

template<class Solver>
MatVec_3T<Solver>::MatVec_3T( Solver *p )
    : PCG_MatVec<Solver::NumT>(),
      solver(p),
      its(0)
{
}

//---------------------------------------------------------------------------//
// Evaluate matrix-vector product.
//---------------------------------------------------------------------------//

template<class Solver>
void MatVec_3T<Solver>::MatVec( Mat1<T>& b, const Mat1<T>&x )
{
    its++;

    Banded_Matrix<double,7>& A = solver->get_A();

    A.multiply( x, b );
}

//---------------------------------------------------------------------------//
//                              end of MatVec_3T.cc
//---------------------------------------------------------------------------//
