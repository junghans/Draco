<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<!--Converted with LaTeX2HTML 98.1p1 release (March 2nd, 1998)
originally by Nikos Drakos (nikos@cbl.leeds.ac.uk), CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>A First Solution</TITLE>
<META NAME="description" CONTENT="A First Solution">
<META NAME="keywords" CONTENT="cip">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<LINK REL="STYLESHEET" HREF="cip.css">
<LINK REL="next" HREF="node5.html">
<LINK REL="previous" HREF="node3.html">
<LINK REL="up" HREF="cip.html">
<LINK REL="next" HREF="node5.html">
</HEAD>
<BODY >

<A NAME="tex2html60"
 HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html58"
 HREF="cip.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html52"
 HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <BR>
<B> Next:</B> <A NAME="tex2html61"
 HREF="node5.html">Refinement</A>
<B>Up:</B> <A NAME="tex2html59"
 HREF="cip.html">Container-Free Numerical Algorithms in</A>
<B> Previous:</B> <A NAME="tex2html53"
 HREF="node3.html">Modern C++ Culture</A>
<BR> <P>

<!--End of Navigation Panel-->

<H1><A NAME="SECTION00040000000000000000">
A First Solution</A>
</H1>

<P>
Taking a cue from the STL, we can reformulate the algorithm in such a
way that it is parameterized on the types of containers which will be
passed to it.  The result is in Figure&nbsp;<A HREF="node4.html#ltsolve2">3</A>.  By using the
template parameters <TT>Matrix</TT> and <TT>Vector</TT> to represent two and
one dimensional containers respectively, <TT>ltsolve2</TT> is couched as
a generic algorithm that can be called with any types of user defined
containers.  This is a big improvement over <TT>ltsolve1</TT>.

<P>
<BR>
<DIV ALIGN="CENTER"><A NAME="ltsolve2">&#160;</A><A NAME="347">&#160;</A>
<TABLE WIDTH="50%">
<CAPTION><STRONG>Figure 3:</STRONG>
First attempt at parameterizing the solve on the types of the user's data containers.</CAPTION>
<TR><TD><IMG
 WIDTH="656" HEIGHT="524"
 SRC="img4.gif"
 ALT="\begin{figure}\begin{tex2html_preform}\begin{verbatim}// ltsolve2.cc
// Implemen...
...x(r) = (b(r) - z) / A(r,r);
}
}\end{verbatim}\end{tex2html_preform}\end{figure}"></TD></TR>
</TABLE>
</DIV>
<BR>
<P>
Well, it can be <EM>called</EM>.  Whether or not it can be <EM>compiled</EM>
is another question entirely!  The central issue is that of
constraints.  This expression of the algorithm places several
constraints on the templating argument types <TT>Matrix</TT> and <TT>Vector</TT>.  These constraints generally fall into two categories.  The
first of these are properly called ``template constraints'', and
represent specific <EM>services</EM> that a template is required to
provide.  The second category are qualitatively different, and for
lack of pre-existing terminology, I will call them ``implicit
constraints'', representing <EM>behaviors</EM> that a template is
required to exhibit.  Whether or not <TT>ltsolve2</TT> can be <EM>compiled</EM> depends on the <EM>services</EM> provided by the types <TT>Matrix</TT> and <TT>Vector</TT>; whether or not it executes correctly and
produces the right answer depends on the <EM>behaviors</EM> exhibited by
objects of these types.  

<P>
The template constraints placed on (services required of) <TT>Matrix</TT>
are:
<UL>
<P>
<LI>Must have a method ``<TT>operator()(int,int) const</TT>'' which can be
used to index the contained data.

<P>
<LI>Must have methods ``<TT>int nx() const</TT>'' and ``<TT>int ny()
const</TT>'' which can be used to determine the dimensions of the
contained data.

<P>
<LI>Must export a type ``<TT>NumT</TT>'' which represents the type of
the contained data.

<P>
</UL>The template constraints on <TT>Vector</TT> are similar:
<UL>
<P>
<LI>Must have methods ``<TT>operator()(int)</TT>'' and ``<TT>operator()(int) const</TT>'' which can be used to index the data.

<P>
<LI>Must have a method ``<TT>int nx() const</TT>'' for determining the
number of contained elements.

<P>
</UL>The principle implicit constraint which <TT>ltsolve2</TT> places on
objects of both of these types is that they must support ``one based
indexing''.

<P>
Let us evaluate this reformulation.  There are several points to note:
<UL>
<P>
<LI><TT>ltsolve2</TT> can be called with pretty much any argument types
the user may have, as long as they comply with the constraints
documented above.

<P>
<LI>The template (service) constraints are in some sense reasonable,
in that they represent requirements that one would naively expect
numeric container classes to be able to satisfy.

<P>
<LI>They nevertheless can be problematic.  Specifically, the coding
of this algorithm requires that <TT>Vector</TT> not only be able to say
how many elements it contains, but moreover, that it be able to say so
when asked the ``<TT>.nx()</TT>'' question.  A particularly noteworthy
container that cannot do this is the <TT>std::vector&lt;T&gt;</TT> class, which
uses a method ``<TT>int size() const</TT>'' to report this information.
The central point here is that a user might have to modify a container
class in order to make it satisfy the constraints placed on it by the
<TT>ltsolve2</TT> function, and this can be burdensome indeed!  Some
classes may not be able to be modified for one reason or another, 

<P>
<LI>Finally, the implicit constraint of using one based indexing is
particularly vexing.  Making a container support one based indexing,
if it already employs zero based indexing, would require changes to
other parts of code.  Such a cost is basically too high to bear, and
the result will likely be that the user would still feel compelled to
get in and muck with the <TT>ltsolve2</TT> source itself.

<P>
</UL>
<P>
<HR>
<A NAME="tex2html60"
 HREF="node5.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next_motif.gif"></A> 
<A NAME="tex2html58"
 HREF="cip.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_motif.gif"></A> 
<A NAME="tex2html52"
 HREF="node3.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="previous_motif.gif"></A>   <BR>
<B> Next:</B> <A NAME="tex2html61"
 HREF="node5.html">Refinement</A>
<B>Up:</B> <A NAME="tex2html59"
 HREF="cip.html">Container-Free Numerical Algorithms in</A>
<B> Previous:</B> <A NAME="tex2html53"
 HREF="node3.html">Modern C++ Culture</A>

<!--End of Navigation Panel-->
<ADDRESS>
<I>Mark Gray <BR>
1998-05-20</I>
</ADDRESS>
</BODY>
</HTML>
